---
title: "Security Warning: New Zero-day Log4J2 Vulnerability"
author: Uday Shankar
---
---

A zero-day vulnerability is an unintentional software security flaw identified in the application, poses a zero-day threat. Vulnerabilities can result from improper software security configurations and programming errors; if left unaddressed, it has the potential to be exploited by cybercriminals. 

A new zero-day vulnerability was reported in the Log4j2 library on Dec 9th, 2021, **affecting the library versions >=2.0-beta9 and <=2.14**. It has the potential to allow an attacker to execute the code remotely. Log4j2 has instantaneously provided the fix by releasing the 2.15.0 version on the same day, Dec 9th, 2021.

## Is the WaveMaker application affected?

WaveMaker applications depend on Log4j2 version **2.14.1**, which got affected by this vulnerability. Considering its severity level, i.e., with a CVSS score of: 10.0 (CVSS:3.0/AV:N/AC:L/PR:N/UI:N/S:C/C:H/I:H/A:H), it is highly recommended to upgrade the Log4j2 version to **2.15.0**. 


## Action Plan

WaveMaker has planned to upgrade the Log4j2 version in an upcoming hotfix release v10.10.2 release scheduled for 21st Dec, 2021.

# Risk Mitigation

There are two ways to mitigate the risk before planned hotfix release.

## Maven: Upgrade the Log4j2 version manually

Add the latest version of Log4j2 2.15.0 dependencies in the `<dependencies>` (not under `<dependencyManagement>`) section in your project’s `pom.xml`.

:::note
Since this mitigation needs a change in the project, the application has to be rebuilt and redeployed.
:::

```xml
<dependency>
    <groupId>org.apache.logging.log4j</groupId>
    <artifactId>log4j-api</artifactId>
    <version>2.15.0</version>
</dependency>
<dependency>
    <groupId>org.apache.logging.log4j</groupId>
    <artifactId>log4j-core</artifactId>
    <version>2.15.0</version>
</dependency>
<dependency>
    <groupId>org.apache.logging.log4j</groupId>
    <artifactId>log4j-slf4j-impl</artifactId>
    <version>2.15.0</version>
</dependency>
```

## System Properties: Disable Lookups in Log4j2

Set either the system property **`log4j2.formatMsgNoLookups`** or environment variable **`LOG4J_FORMAT_MSG_NO_LOOKUPS`** to true. This mitigation doesn’t need rebuilding of the war file. Tomcat or any web application server where the wavemaker application is running needs to be set to one of the above mentioned properties and restarted.

:::note
As this mitigation is required in the runtime environment, there is no need to rebuild the application. Restarting the tomcat or web server would be good enough.
:::

**Example**: For Apache tomcat, below changes can be done to set system property and system environment variable.


### For Unix and Mac systems

Add the below in `setenv.sh` file of tomcat bin folder. 

1. The follwing adds a system property:

```
export JAVA_OPTS="$JAVA_OPTS -Dlog4j2.formatMsgNoLookups=true” 
```

2. The following add an environment variable

```
export LOG4J_FORMAT_MSG_NO_LOOKUPS=true (Adds an environment variable)
```

### For Windows System 

Add the below in the `setenv.bat` file of tomcat bin folder.

1. The following adds a system property.

```
set JAVA_OPTS="$JAVA_OPTS -Dlog4j2.formatMsgNoLookups=true” (Adds a system property)
```

2. The following adds an environment variable.

```
set LOG4J_FORMAT_MSG_NO_LOOKUPS=true (Adds an environment variable)
```

