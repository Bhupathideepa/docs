---
title: "Mitigating Log4J 2 Vulnerability CVE 2021 44228"
author: Uday Shankar
---
---

A zero-day vulnerability is an unintentional software security flaw identified in the application, poses a zero-day threat. 

A new [zero-day vulnerability](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2021-44228) was reported in the Log4j2 library on 9th Dec 2021, **affecting the library versions >=2.0-beta9 and <=2.14**. It has the potential to allow an attacker to execute the code remotely. Log4j2 has instantaneously provided the fix by releasing the 2.15.0 version on the same day, 9th Dec 2021.

<!--truncate-->

## Is WaveMaker Application Affected?

WaveMaker applications depend on Log4j2 version **2.14.1**, which got affected by this vulnerability. Considering its severity level, i.e., with a CVSS score of: 10.0 `(CVSS:3.0/AV:N/AC:L/PR:N/UI:N/S:C/C:H/I:H/A:H)`, it is highly recommended to upgrade the Log4j2 version to **2.15.0**. 


## Action Plan

WaveMaker has planned to upgrade the Log4j2 version in an upcoming hotfix v10.10.2 release scheduled for 21st Dec 2021.

# Risk Mitigation

There are two ways to mitigate the risk before the planned hotfix release.

## Maven: Upgrade the Log4j2 Version Manually

Add the latest version of Log4j2 2.15.0 dependencies in the **`<dependencies>`** section, and NOT under the `<dependencyManagement>` section in your project's `pom.xml` file.

:::note
Since this mitigation needs a change in the project, the application must be rebuilt and redeployed.
:::

```xml
<dependency>
    <groupId>org.apache.logging.log4j</groupId>
    <artifactId>log4j-api</artifactId>
    <version>2.15.0</version>
</dependency>
<dependency>
    <groupId>org.apache.logging.log4j</groupId>
    <artifactId>log4j-core</artifactId>
    <version>2.15.0</version>
</dependency>
<dependency>
    <groupId>org.apache.logging.log4j</groupId>
    <artifactId>log4j-slf4j-impl</artifactId>
    <version>2.15.0</version>
</dependency>
```

## System Properties: Disable Lookups in Log4j2

Set either the System Property **`log4j2.formatMsgNoLookups`** or Environment Variable **`LOG4J_FORMAT_MSG_NO_LOOKUPS`** to **`True`**. This mitigation does not need rebuilding of the war file. Tomcat or any web application server where the WaveMaker application is running needs to be set to one of the above-mentioned properties and restarted.

:::note
As this mitigation is required in the runtime environment, there is no need to rebuild the application. Restarting the tomcat or web server would be good enough.
:::

**Example**: For Apache tomcat, the below changes can be done to set system property and system environment variable.


### Unix and Mac Systems

Add the below in the `setenv.sh` file of the tomcat bin folder. 

1. The following adds a System property.

```
export JAVA_OPTS="$JAVA_OPTS -Dlog4j2.formatMsgNoLookups=true” 
```

2. The following add an Environment variable.

```
export LOG4J_FORMAT_MSG_NO_LOOKUPS=true 
```

### Windows System 

Add the below in the `setenv.bat` file of the tomcat bin folder.

1. The following adds a System property.

```
set JAVA_OPTS="$JAVA_OPTS -Dlog4j2.formatMsgNoLookups=true” 
```

2. The following adds an Environment variable.

```
set LOG4J_FORMAT_MSG_NO_LOOKUPS=true (Adds an environment variable)
```

